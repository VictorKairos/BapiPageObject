var webdriver = require('selenium-webdriver');

var driver = new webdriver.Builder().
    usingServer('http://localhost.applitools.com:4444/wd/hub').
    withCapabilities(webdriver.Capabilities.chrome()).
    build();

var Eyes = require('./../src/Eyes');
var eyes = new Eyes();
eyes.setApiKey("fy11O5GelVm856YF4q5vlF50AnuRiY5301y1Kj0LjTk110");

eyes.open(driver, "JavaScript SDK", "Simple JS SDK Test - github").then(function(driver2) {
    driver2.get('https://github.com');
    eyes.checkWindow("github");
    driver2.findElement(webdriver.By.name('user[login]')).sendKeys('webdriver');
    eyes.checkRegionByElement(driver.findElement(webdriver.By.className('form-signup-home')), 'login');
    driver2.findElement(webdriver.By.name('user[email]')).sendKeys('test@email.com');
    eyes.checkRegionBy(webdriver.By.className('subheading'), 'login2');
    driver2.findElement(webdriver.By.name('user[password]')).sendKeys('Password321');
    driver2.wait(function() {
        return driver.getTitle().then(function(title) {
            return title === 'GitHub Â· Build software better, together.';
        });
    }, 1000);

    eyes.close();
    driver2.quit();
});